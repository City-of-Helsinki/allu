<div materialize class="row">
  <div class="col m6 loose">
    <md-card>
      <md-card-title>Hakija</md-card-title>
      <md-card-content>
        <div class="row">
          <div class="input-field col m6">
            <select *ngIf="!isSummary" [(ngModel)]="application.applicant.type"
                    (change)="applicantTypeSelection($event.target.value)"
                    materialize="material_select" [materializeSelectOptions]="selectOptions">
              <option value="" disabled selected>Valitse hakijan tyyppi</option>
              <option *ngFor="let type of applicantType" [value]="type.value">{{type.name}}</option>
            </select>
            <input *ngIf="isSummary" type="text" [disabled]="true" [(ngModel)]="application.applicant.type">
          </div>
          <div class="col m6 country-select">
            <select *ngIf="!isSummary" [(ngModel)]="country"
                    materialize="material_select" [materializeSelectOptions]="selectOptions">
              <option value="" disabled selected>Maa</option>
              <option *ngFor="let country of countries" [value]="country">{{country.name}}</option>
            </select>
            <input *ngIf="isSummary" type="text" [disabled]="true" value="Suomi">
          </div>
          <div class="input-field col m8">
            <input id="applicantName" type="text" class="validate" [(ngModel)]="application.applicant.details.name" [disabled]="isSummary">
            <label for="applicantName">{{applicantNameSelection}}</label>
          </div>
          <div class="input-field col m4">
            <input id="businessID" type="text" class="validate" [(ngModel)]="application.applicant.details.identifier" [disabled]="isSummary">
            <label for="businessID">{{applicantIdSelection}}</label>
          </div>
          <div class="input-field col m6">
            <input id="applicantAddress" type="text" class="validate"
                   [(ngModel)]="application.applicant.details.postalAddress.streetAddress" [disabled]="isSummary">
            <label for="applicantAddress">{{ meta?.getUiName('applicant.address') }}</label>
          </div>
          <div class="input-field col m3">
            <input id="applicantPostalCode" type="text" class="validate"
                   [(ngModel)]="application.applicant.details.postalAddress.postalCode" [disabled]="isSummary">
            <label for="applicantPostalCode">{{ meta?.getUiName('applicant.postalCode') }}</label>
          </div>
          <div class="input-field col m3">
            <input id="applicantCity" type="text" class="validate" [(ngModel)]="application.applicant.details.postalAddress.city" [disabled]="isSummary">
            <label for="applicantCity">{{ meta?.getUiName('applicant.postOffice') }}</label>
          </div>
          <div class="input-field col m4">
            <input id="applicantPhone" type="text" class="validate" [(ngModel)]="application.applicant.details.phone" [disabled]="isSummary">
            <label for="applicantPhone">{{ meta?.getUiName('applicant.phoneNumber') }}</label>
          </div>
          <div class="input-field col m8">
            <input id="applicantEmail" type="text" class="validate" [(ngModel)]="application.applicant.details.email" [disabled]="isSummary">
            <label for="applicantEmail">{{ meta?.getUiName('applicant.email') }}</label>
          </div>
          <div class="col m7 height-fix-bottom">
            <input type="checkbox" class="filled-in" id="copyToBilling" [disabled]="isSummary"/>
            <label for="copyToBilling">Kopioi tiedot laskutusosoitteeksi</label>
          </div>
          <div class="col m5 height-fix-bottom">
            <input type="checkbox" class="filled-in" [(ngModel)]="application.applicant.representative" id="representative" [disabled]="isSummary"/>
            <label for="representative">Asiaa hoitaa asiamies</label>
          </div>
        </div>
      </md-card-content>
    </md-card>
  </div>

  <div class="col m6 loose">
    <md-card>
      <md-card-title>Yhteyshenkilö</md-card-title>
      <md-card-content>
        <div class="row">
          <div class="input-field col m12">
            <input id="contactName" type="text" class="validate" [(ngModel)]="application.contactList[0].name" [disabled]="isSummary">
            <label for="contactName">{{ meta?.getUiName('contact.contactName') }}</label>
          </div>
          <div class="input-field col m6">
            <input id="contactStreetAddress" type="text" class="validate" [(ngModel)]="application.contactList[0].streetAddress" [disabled]="isSummary">
            <label for="contactStreetAddress">{{ meta?.getUiName('contact.address') }}</label>
          </div>
          <div class="input-field col m3">
            <input id="contactPostalCode" type="text" class="validate" [(ngModel)]="application.contactList[0].postalCode" [disabled]="isSummary">
            <label for="contactPostalCode">{{ meta?.getUiName('contact.postalCode') }}</label>
          </div>
          <div class="input-field col m3">
            <input id="contactCity" type="text" class="validate" [(ngModel)]="application.contactList[0].city" [disabled]="isSummary">
            <label for="contactCity">{{ meta?.getUiName('contact.postOffice') }}</label>
          </div>
          <div class="input-field col m4">
            <input id="contactPhone" type="text" class="validate" [(ngModel)]="application.contactList[0].phone" [disabled]="isSummary">
            <label for="contactPhone">{{ meta?.getUiName('contact.phoneNumber') }}</label>
          </div>
          <div class="input-field col m8">
            <input id="contactEmail" type="text" class="validate" [(ngModel)]="application.contactList[0].email" [disabled]="isSummary">
            <label for="contactEmail">{{ meta?.getUiName('contact.email') }}</label>
          </div>
          <div *ngIf="!isSummary" class="buttons col m12">
            <button md-raised-button class="waves-effect waves-light btn" (click)="saveToRegistry(application.contactList[0])">TALLENNA REKISTERIIN</button>
            <button md-raised-button class="waves-effect waves-light btn" (click)="newContact(application.contactList[0])">UUSI YHTEYSHENKILÖ</button>
          </div>
        </div>
      </md-card-content>
    </md-card>
  </div>

  <!-- TODO: error handling for missing billing info
   <div class="col m12">
      <md-card>
        <md-card-title>Laskutusosoite</md-card-title>
        <md-card-content>
          <div class="row">
            <div class="col m6 no-padding">
              <div class="col m6 country-select">
                <select materialize="material_select" [materializeSelectOptions]="selectOptions" [(ngModel)]="application.billingDetail.type">
                  <option value="" disabled selected>Valitse laskutustapa</option>
                  <option *ngFor="let type of billingTypes" [value]="type.value">{{type.name}}</option>
                </select>
              </div>
              <div class="col m6 country-select">
                <select materialize="material_select" [materializeSelectOptions]="selectOptions" [(ngModel)]="application.billingDetail.country">
                  <option value="" disabled selected>Maa</option>
                  <option *ngFor="let country of countries" [value]="country.value">{{country.name}}</option>
                </select>
              </div>
              <div class="input-field col m6">
                <input id="billingAddress" type="text" class="validate" [(ngModel)]="application.billingDetail.postalAddress.streetAddress">
                <label for="billingAddress">Osoite</label>
              </div>
              <div class="input-field col m3">
                <input id="billingPostalCode" type="text" class="validate" [(ngModel)]="application.billingDetail.postalAddress.postalCode">
                <label for="billingPostalCode">Postinumero</label>
              </div>
              <div class="input-field col m3">
                <input id="billingCity" type="text" class="validate" [(ngModel)]="application.billingDetail.postalAddress.city">
                <label for="billingCity">Toimipaikka</label>
              </div>
            </div>
            <div class="col m6">
              <div class="input-field col m6 offset-m3">
                <input id="billingWorkNumber" type="text" class="validate" [(ngModel)]="application.billingDetail.workNumber">
                <label for="billingWorkNumber">Työnumero</label>
              </div>
              <div class="input-field col m6 offset-m3">
                <input id="billingReference" type="text" class="validate" [(ngModel)]="application.billingDetail.reference">
                <label for="billingReference">Laskutusviite</label>
              </div>
            </div>
          </div>
        </md-card-content>
      </md-card>
    </div> -->

  <div class="col m12 loose">
    <md-card>
      <md-card-title>Tapahtuman tiedot</md-card-title>
      <md-card-content>
        <div class="row">
          <div class="col m6">
            <div class="input-field col m12">
              <input id="eventName" type="text" class="validate" [class.summary]="application.name" [(ngModel)]="application.name" [disabled]="isSummary">
              <label for="eventName">{{ meta?.getUiName('name') }}</label>
            </div>
            <div class="input-field col m12">
              <textarea id="eventDescription" class="materialize-textarea" [(ngModel)]="application.event.description" [disabled]="isSummary"></textarea>
              <label for="eventDescription">{{ meta?.getUiName('description') }}</label>
            </div>
            <div class="input-field col m12">
              <input id="eventUrl" type="text" class="validate" [(ngModel)]="application.event.url" [disabled]="isSummary">
              <label for="eventUrl">{{ meta?.getUiName('url') }}</label>
            </div>
          </div>
          <div class="col m6 no-padding">
            <div class="input-field col m12">
              <input id="eventStartTime"
                     [(ngModel)]="application.event.uiStartTime"
                     materialize="pickadate"
                     [materializeParams]="pickadateParams"
                     type="text" [disabled]="isSummary"/>
              <label for="eventStartTime">{{ meta?.getUiName('eventStartTime') }}</label>
            </div>
            <div class="input-field col m12">
              <input id="eventEndTime"
                     [(ngModel)]="application.event.uiEndTime"
                     materialize="pickadate"
                     [materializeParams]="pickadateParams"
                     type="text" [disabled]="isSummary"/>
              <label for="eventEndTime">{{ meta?.getUiName('eventEndTime') }}</label>
            </div>
            <div class="input-field col m12">
              <textarea id="eventTimeExceptions" class="materialize-textarea" [(ngModel)]="application.event.timeExceptions" [disabled]="isSummary"></textarea>
              <label for="eventTimeExceptions">{{ meta?.getUiName('timeExceptions') }}</label>
            </div>
            <div class="input-field col m3">
              <input id="eventAttendees" type="number" class="validate" [(ngModel)]="application.event.attendees" [disabled]="isSummary">
              <label for="eventAttendees">{{ meta?.getUiName('attendees') }}</label>
            </div>
            <div class="input-field col m9">
              <input id="eventEntryFee" type="number" class="validate" [(ngModel)]="application.event.entryFee" [disabled]="isSummary">
              <label for="eventEntryFee">{{ meta?.getUiName('entryFee') }}</label>
            </div>
          </div>
        </div>
      </md-card-content>
    </md-card>
  </div>

  <div class="col m12 loose">
    <md-card>
      <md-card-title>Rakenteet</md-card-title>
      <md-card-content>
        <div class="row">
          <div class="col m6 no-padding">
            <div class="col m6 height-fix-top">
              <input type="checkbox" class="filled-in" id="structureIncluded" [checked]="application.event.structureArea" [disabled]="isSummary"/>
              <label for="structureIncluded">Tapahtuma sisältää rakenteita</label>
            </div>
            <div class="input-field col m6">
              <input id="structureArea" type="number" class="validate" step="any" [(ngModel)]="application.event.structureArea" [disabled]="isSummary">
              <label for="structureArea">{{ meta?.getUiName('structureArea') }}</label>
            </div>
            <div class="input-field col m12">
                <textarea id="structureDescription" class="materialize-textarea textarea"
                          [(ngModel)]="application.event.structureDescription" [disabled]="isSummary"></textarea>
              <label for="structureDescription">{{ meta?.getUiName('structureDescription') }}</label>
            </div>

          </div>
          <div class="col m6 no-padding">
            <div class="col m12 height-fix-top height-fix-bottom">
              <input type="checkbox" class="filled-in" id="structureBuildDate"
                     [checked]="application.event.structureStartTime || application.event.structureEndTime" [disabled]="isSummary"/>
              <label for="structureBuildDate">Tapahtuma vaatii erillisiä rakennus- tai purkupäiviä</label>
            </div>
            <div class="input-field col m12">
              <label for="structureStartTime">{{ meta?.getUiName('structureStartTime') }}</label>
              <input id="structureStartTime"
                     [(ngModel)]="application.event.uiStructureStartTime"
                     materialize="pickadate"
                     [materializeParams]="pickadateParams"
                     type="text" [disabled]="isSummary"/>
            </div>
            <div class="input-field col m12">
              <label for="structureEndTime">{{ meta?.getUiName('structureEndTime') }}</label>
              <input id="structureEndTime"
                     [(ngModel)]="application.event.uiStructureEndTime"
                     materialize="pickadate"
                     [materializeParams]="pickadateParams"
                     type="text" [disabled]="isSummary"/>
            </div>
          </div>
        </div>
      </md-card-content>
    </md-card>
  </div>

  <div class="col m12 loose">
    <md-card>
      <md-card-title>Hinnoitteluperusteet</md-card-title>
      <md-card-content>
        <div class="row">
          <div class="col m6">
            <div class="col m12">
              <select materialize="material_select" [materializeSelectOptions]="selectOptions"
                      [(ngModel)]="application.event.nature" (change)="eventNatureChange($event.target.value)" [disabled]="isSummary">
                <option value="" disabled selected>{{ meta?.getUiName('nature') }}</option>
                <option *ngFor="let nature of eventNatures" [value]="nature.value">{{nature.name}}</option>
              </select>
            </div>
            <div class="col m12 height-fix-bottom" *ngIf="application.event.nature === 'PUBLIC_FREE'">
              <input type="checkbox" class="filled-in" id="noPrice" [(ngModel)]="noPrice" [disabled]="isSummary"/>
              <label for="noPrice">Korvauksetta</label>
            </div>
            <div class="col m12" *ngIf="noPrice">
              <select materialize="material_select" [materializeSelectOptions]="noPriceReasons"
                      [(ngModel)]="application.event.noPriceReason" [disabled]="isSummary">
                <option value="" disabled selected>{{ meta?.getUiName('noPriceReason') }}</option>
                <option *ngFor="let reason of noPriceReasons" [value]="reason.value">{{reason.name}}</option>
              </select>
            </div>
          </div>
          <div class="col m6 no-padding">
            <div class="col m12 height-fix-bottom">
              <input type="checkbox" class="filled-in" id="pricingEcoCompass" [(ngModel)]="application.event.ecoCompass" [disabled]="isSummary"/>
              <label for="pricingEcoCompass">{{ meta?.getUiName('ecoCompass') }}</label>
            </div>
            <div class="col m12 height-fix-bottom" *ngIf="noPrice">
              <input type="checkbox" class="filled-in" id="pricingSalesActivity" [(ngModel)]="application.event.salesActivity" [disabled]="isSummary"/>
              <label for="pricingSalesActivity">{{ meta?.getUiName('salesOrPromotionThemeless') }}</label>
            </div>
            <div class="col m12 height-fix-bottom" *ngIf="noPrice">
              <input type="checkbox" class="filled-in" id="includesHeavyStructure" [(ngModel)]="application.event.heavyStructure" [disabled]="isSummary"/>
              <label for="includesHeavyStructure">{{ meta?.getUiName('heavyStructure') }}</label>
            </div>
          </div>
          <div class="col m12">
            <div class="col m12">
              <label for="price">Hinta</label>
              <div id="price">-</div>
            </div>
          </div>
        </div>
      </md-card-content>
    </md-card>
  </div>

  <div *ngIf="isSummary" class="col m12 loose">
    <md-card>
      <md-card-title>Sijainti</md-card-title>
      <md-card-content>
        <div class="row">
          <div class="col m8">
            <div class="input-field col m3">
              <input id="address" type="text" [ngModel]="application.location.postalAddress.streetAddress" [disabled]="isSummary">
              <label for="address">Osoite</label>
            </div>
            <div class="input-field col m9">
              <input id="info" type="text" [ngModel]="application.location.info" [disabled]="isSummary">
              <label for="info">Lisätietoja paikasta</label>
            </div>
            <div class="input-field col m8 select-fix" [class.summary]="rentingPlace">
              <input type="text" [ngModel]="squareSection.square" [disabled]="isSummary">
            </div>
            <div class="input-field col m2 select-fix" [class.summary]="sections">
              <input type="text" [ngModel]="squareSection.section" [disabled]="isSummary">
            </div>
            <div class="input-field col m2">
              <input id="area" type="number" class="validate" [ngModel]="application.location.uiArea" [disabled]="isSummary">
              <label for="area">Alueen pinta-ala</label>
            </div>
          </div>
          <div class="col m2 offset-m2">
            <button md-raised-button class="waves-effect waves-light btn" [routerLink]="['/location',  application.id]">MUOKKAA</button>
          </div>
          <div class="col m12">
            <div class="mapcontainer">
              <map [selection]="true" [applicationId]="application.id" [showOnlyApplicationArea]="true"></map>
            </div>
          </div>
        </div>
      </md-card-content>
    </md-card>
  </div>

  <div class="col m12 loose">
    <md-card>
      <md-card-title>Myyntitoiminta</md-card-title>
      <md-card-content>
        <div class="row">
          <div class="col m6 no-padding">
            <div class="col m12 height-fix-bottom">
              <input type="checkbox" class="filled-in" id="salesMarketing" [checked]="application.event.marketingProviders" [disabled]="isSummary"/>
              <label for="salesMarketing">Tapahtuma sisältää myynti- tai mainostoimintaa</label>
            </div>
            <div class="input-field col m12">
                <textarea id="salesMarketingDetails" class="materialize-textarea"
                          [(ngModel)]="application.event.marketingProviders" [disabled]="isSummary"></textarea>
              <label for="salesMarketingDetails">{{ meta?.getUiName('salesOrPromotionDescription') }}</label>
            </div>
          </div>
          <div class="col m6 no-padding">
            <div class="col m12 height-fix-bottom">
              <input type="checkbox" class="filled-in" id="salesFood" [checked]="application.event.foodSales" [disabled]="isSummary"/>
              <label for="salesFood">{{ meta?.getUiName('foodSales') }}</label>
            </div>
            <div class="input-field col m12">
              <textarea id="salesFoodProviders" class="materialize-textarea" [(ngModel)]="application.event.foodProviders" [disabled]="isSummary"></textarea>
              <label for="salesFoodProviders">{{ meta?.getUiName('foodProviders') }}</label>
            </div>
          </div>
        </div>
      </md-card-content>
    </md-card>
  </div>


  <!--
      <div class="col m12">
        <md-card>
          <md-card-title>Sisäiset kommentit</md-card-title>
          <md-card-content>
            <div class="row">
              <div class="input-field col m12">
                <textarea id="comments" class="materialize-textarea" [(ngModel)]="application.comments"></textarea>
                <label for="comments">Kirjoita kommentti</label>
              </div>
            </div>
          </md-card-content>
        </md-card>
      </div>
  -->
  <application-attachment [existingAttachments]="application.attachmentList" [readonly]="isSummary" (currentAttachments)="currentAttachments($event)"></application-attachment>
  <div class="col m12 loose">
    <md-card>
      <md-card-title>Tallennus</md-card-title>
      <md-card-content>
        <div class="row">
          <div *ngIf="!isSummary">
            <div class="col m2 offset-m10">
              <button md-raised-button class="waves-effect waves-light btn" (click)="save(application)" [disabled]="submitted">YHTEENVETOON</button>
            </div>
          </div>

          <div *ngIf="isSummary">
            <div class="col m2">
              <button md-raised-button class="waves-effect waves-light btn" [routerLink]="['/applications', application.id]">MUOKKAA</button>
            </div>
            <div class="col m4 offset-m6">
              <button md-raised-button class="waves-effect waves-light btn" [routerLink]="['/']">ETUSIVULLE</button>
              <button md-raised-button class="waves-effect waves-light btn" [disabled]="true">TYÖJONOON</button>
              <button md-raised-button class="waves-effect waves-light btn" [routerLink]="['/decision', application.id]">PÄÄTTÄMISEEN</button>
            </div>
          </div>
        </div>
      </md-card-content>
    </md-card>
  </div>
</div>
